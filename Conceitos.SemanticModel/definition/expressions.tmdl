expression Lista =
		let
		    Fonte1 = {1, 2, 3},
		    Fonte2 = {1, 2, 3, "Diego"},
		    Fonte3 = {{1,2,3},{"a","b","c"}},
		    Fonte4 = {20, 35, 40}{0},
		    Fonte5 = {1 .. 100},
		    Fonte6 = {1,2,3} & {4 .. 10}
		in
		    Fonte6
	lineageTag: 32a61d6e-9744-44bf-a7d4-a32363d43912

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = List

expression Registro =
		let
		    Fonte = [
		        Coluna1 = "Produto X",
		        Coluna2 = "Região Y",
		        Coluna3 = 680,
		        Coluna4 = {1001, 1006, 1008},
		        Coluna5 = [
		            ColunaX = 600,
		            ColunaW = "Vendedor1"
		        ]
		    ]
		in
		    Fonte
	lineageTag: 68441b80-2d55-45d0-b482-288e379c4ec0

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Record

expression Tabela = ```
		let
		    Fonte = 
		    #table(
		        {"Nome", "Idade"},
		        {
		            {"Diego",43},
		            {"Bia", 26}
		        }
		    )
		in
		    Fonte
		```
	lineageTag: 083b1691-5517-4436-b816-d0186a8de31a

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

expression EstruturaSimples =
		let
		    Etapa1 = "a",
		    Etapa2 = "b",
		    #"Etapa 3" = 50,
		    num1 = 10,
		    num2 = 2,
		    num3 = 50,
		    num4 = num3 * num2 / num1
		in
		    num4
	lineageTag: b9111656-93d9-4b2e-9b83-0b9bec405ece

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Number

expression EstruturaAninhada = ```
		let
		    etapa1 = 5,
		    etapa2 = 
		        let
		            etapa3 = 600
		        in
		            etapa3,
		
		    // Exemplo de erro de escopo e irá retornar a seguinte mensagem: Expression.Error: O nome 'etapa3' não foi reconhecido. Certifique-se de que ele foi soletrado corretamente.
		    // remova o comentário abaixo para ver o erro.
		    // etapa4 = etapa3 / etapa1
		    
		    // correção da etapa comentada acima.        
		    etapa4 = etapa2 / etapa1
		
		    
		in
		    etapa4
		```
	lineageTag: 8a222f59-39a7-4ae9-8834-d6316598b320

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Number

expression ListaFunções =
		let
		    Fonte = #shared,
		    #"Convertido para Tabela" = Record.ToTable(Fonte),
		    #"Linhas Filtradas" = Table.SelectRows(#"Convertido para Tabela", each ([Name] = "Table.AddColumn" or [Name] = "Table.AddIndexColumn" or [Name] = "Table.AddJoinColumn" or [Name] = "Table.AddKey" or [Name] = "Table.AddRankColumn" or [Name] = "Table.AggregateTableColumn" or [Name] = "Table.AlternateRows" or [Name] = "Table.ApproximateRowCount" or [Name] = "Table.Column" or [Name] = "Table.ColumnCount" or [Name] = "Table.ColumnNames" or [Name] = "Table.ColumnsOfType" or [Name] = "Table.Combine" or [Name] = "Table.CombineColumns" or [Name] = "Table.CombineColumnsToRecord" or [Name] = "Table.ConformToPageReader" or [Name] = "Table.Contains" or [Name] = "Table.ContainsAll" or [Name] = "Table.ContainsAny" or [Name] = "Table.DemoteHeaders" or [Name] = "Table.Distinct" or [Name] = "Table.DuplicateColumn" or [Name] = "Table.ExpandListColumn" or [Name] = "Table.ExpandRecordColumn" or [Name] = "Table.ExpandTableColumn" or [Name] = "Table.FillDown" or [Name] = "Table.FillUp" or [Name] = "Table.FilterWithDataTable" or [Name] = "Table.FindText" or [Name] = "Table.First" or [Name] = "Table.FirstN" or [Name] = "Table.FirstValue" or [Name] = "Table.FromColumns" or [Name] = "Table.FromList" or [Name] = "Table.FromPartitions" or [Name] = "Table.FromRecords" or [Name] = "Table.FromRows" or [Name] = "Table.FromValue" or [Name] = "Table.Group" or [Name] = "Table.HasColumns" or [Name] = "Table.InsertRows" or [Name] = "Table.IsDistinct" or [Name] = "Table.IsEmpty" or [Name] = "Table.Join" or [Name] = "Table.Keys" or [Name] = "Table.Last" or [Name] = "Table.LastN" or [Name] = "Table.MatchesAllRows" or [Name] = "Table.MatchesAnyRows" or [Name] = "Table.Max" or [Name] = "Table.MaxN" or [Name] = "Table.Min" or [Name] = "Table.MinN" or [Name] = "Table.NestedJoin" or [Name] = "Table.Partition" or [Name] = "Table.PartitionKey" or [Name] = "Table.PartitionValues" or [Name] = "Table.Pivot" or [Name] = "Table.PositionOf" or [Name] = "Table.PositionOfAny" or [Name] = "Table.PrefixColumns" or [Name] = "Table.Profile" or [Name] = "Table.PromoteHeaders" or [Name] = "Table.Range" or [Name] = "Table.RemoveColumns" or [Name] = "Table.RemoveFirstN" or [Name] = "Table.RemoveLastN" or [Name] = "Table.RemoveMatchingRows" or [Name] = "Table.RemoveRows" or [Name] = "Table.RemoveRowsWithErrors" or [Name] = "Table.RenameColumns" or [Name] = "Table.ReorderColumns" or [Name] = "Table.Repeat" or [Name] = "Table.ReplaceErrorValues" or [Name] = "Table.ReplaceKeys" or [Name] = "Table.ReplaceMatchingRows" or [Name] = "Table.ReplacePartitionKey" or [Name] = "Table.ReplaceRelationshipIdentity" or [Name] = "Table.ReplaceRows" or [Name] = "Table.ReplaceValue" or [Name] = "Table.ReverseRows" or [Name] = "Table.RowCount" or [Name] = "Table.Schema" or [Name] = "Table.SelectColumns" or [Name] = "Table.SelectRows" or [Name] = "Table.SelectRowsWithErrors" or [Name] = "Table.SingleRow" or [Name] = "Table.Skip" or [Name] = "Table.Sort" or [Name] = "Table.Split" or [Name] = "Table.SplitColumn" or [Name] = "Table.ToColumns" or [Name] = "Table.ToList" or [Name] = "Table.ToRecords" or [Name] = "Table.ToRows" or [Name] = "Table.TransformColumnNames" or [Name] = "Table.TransformColumns" or [Name] = "Table.TransformColumnTypes" or [Name] = "Table.TransformRows" or [Name] = "Table.Transpose" or [Name] = "Table.Type" or [Name] = "Table.Unpivot" or [Name] = "Table.UnpivotOtherColumns" or [Name] = "Table.View" or [Name] = "Table.ViewError" or [Name] = "Table.ViewFunction"))
		in
		    #"Linhas Filtradas"
	lineageTag: 40a061ef-9183-4f2d-a196-ef6cf7bae6a9

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

expression 'Usando Funções' =
		let
		    // Transformar texto em número
		    A = "20",
		    B = 100,
		    C = Number.FromText(A) * B,
		
		    // Extrair texto após o delimitador e transformar em número
		    D = "F-8543",
		    E = Number.FromText(Text.AfterDelimiter(D, "-")),
		
		    // Ordenar lista
		    F = {56,78,2,73,8,4},
		    G = List.Sort(F)
		in
		    G
	lineageTag: a619bbf7-99df-4527-a8d1-58c48d405720

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = List

expression Pedidos = ```
		let
		
		    // Informar o diretório onde iremos importar os arquivos
		    ImportarArquivos = Folder.Files("Z:\certificacao\DataDriven\Formação em Power BI - M Avançado\arquivos\Pedidos"),
		    
		    // Remover colunas desnecessárias
		    RemoverColunas1 = Table.SelectColumns(ImportarArquivos,{"Content"}),
		
		    // Adicionar coluna personalizada transformando os dados binários de Content em Tabelas
		    AcessarDadosDoExcel = Table.AddColumn(RemoverColunas1, "TransformarBinarioEmTabela", each Excel.Workbook([Content])),
		
		    // Remover a coluna Content já que ela não é mais necessária
		    RemoverColunas2 = Table.RemoveColumns(AcessarDadosDoExcel,{"Content"}),
		
		    // Da tabela anterior, precisamos apenas dos dados contidos na coluna Data(dados em inglês)
		    ExpandirTabelaDeDados = Table.ExpandTableColumn(RemoverColunas2, "TransformarBinarioEmTabela", {"Data"}, {"Dados"}),
		
		    // Adicionar coluna personalizada promovendo os cabeçalhos
		    PromoverCabecalhos = Table.AddColumn(ExpandirTabelaDeDados, "PromoverCabecalhos", each Table.PromoteHeaders([Dados])),
		
		    // Remover a coluna Dados já que ela não é mais necessária
		    RemoverColunas3 = Table.RemoveColumns(PromoverCabecalhos,{"Dados"}),
		
		    // Expandir tabela pronta
		    ExpandirTabelaFinal = Table.ExpandTableColumn(
		        RemoverColunas3, "PromoverCabecalhos", {
		            "Código do Pedido", 
		            "Ano", 
		            "Mês", 
		            "Dia", 
		            "ID Produto", 
		            "ID Loja", 
		            "Quantidade", 
		            "Preço Unitário", 
		            "Tipo Venda"
		        }
		    ),
		    
		    // Tipar colunas
		    TipoAlterado = Table.TransformColumnTypes(
		        ExpandirTabelaFinal,{
		            {"Código do Pedido", Int64.Type}, 
		            {"Ano", Int64.Type}, 
		            {"Mês", Int64.Type}, 
		            {"Dia", Int64.Type}, 
		            {"ID Produto", Int64.Type}, 
		            {"ID Loja", Int64.Type}, 
		            {"Quantidade", Int64.Type}, 
		            {"Preço Unitário", Int64.Type}, 
		            {"Tipo Venda", type text}
		        }
		    )
		in
		    TipoAlterado
		```
	lineageTag: dbe66bfe-c9a1-4661-8e90-e5f0b9b7b920

	annotation PBI_NavigationStepName = Navegação

	annotation PBI_ResultType = Table

